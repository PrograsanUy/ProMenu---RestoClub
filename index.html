<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="estilos.css">
  <title>Generador de Menú Diario</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Anton&family=Horizon&family=Josefin+Sans&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>

<!-- Agregar dentro del <body> -->
<header class="header-container">
  <div class="header-title">ProMenu - Resto Club</div>
  <nav class="header-nav">
    <a href="#" class="nav-item active">Menú</a>
<!--     <a href="#" class="nav-item">Estado</a> -->
    <a href="#" class="nav-item">
      <i class="fas fa-image"></i>
    </a>
  </nav>
</header>


<div class="form-wrapper">
  <input type="file" accept="image/*" id="imagenInput">
  <input type="text" id="nombreInput" placeholder="Nombre del plato">
  <!-- <input type="number" id="telefonoInput" placeholder="Teléfono" maxlength="11"> -->
  <button id="descargarBtn" onclick="descargarImagen()" disabled>Descargar imagen</button>
</div>

<div class="contenedor" id="preview">
  <img id="bg" class="fondo" src="" alt="Fondo">
  <div class="overlay"></div>
  <div class="contenido">
    <img class="logo" src="LogoClubBlancoPNG.png" alt="Logo fijo">
    <div class="titulo">PLATO DEL DÍA</div>
    <div class="fecha-decorada">
      <span class="puntos">&#8226;&#8226;&#8226;</span>
      <span id="fecha">17.07</span>
      <span class="puntos">&#8226;&#8226;&#8226;</span>
    </div>
    <div class="plato-img">
      <img id="plato-img" src="" alt="Plato">
    </div>
    <div class="nombre-plato" id="nombre-plato">MILANESA NAPOLITANA CON PURÉ</div>
    <div class="telefono" id="telefono">092 228 587</div>
    <div class="direccion">25 DE MAYO, 550</div>
  </div>
</div>

<script>
  const imagenInput = document.getElementById('imagenInput');
  const nombreInput = document.getElementById('nombreInput');
  const fechaInput = document.getElementById('fechaInput');
  const telefonoInput = document.getElementById('telefonoInput');

  const fondo = document.getElementById('bg');
  const platoImg = document.getElementById('plato-img');
  const nombrePlato = document.getElementById('nombre-plato');
  const fecha = document.getElementById('fecha');
  const telefono = document.getElementById('telefono');
  const preview = document.getElementById('preview');
  const descargarBtn = document.getElementById('descargarBtn');

  let imagenCargada = false;

  imagenInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (file) {
      const url = URL.createObjectURL(file);
      fondo.src = url;
      platoImg.src = url;
      imagenCargada = true;
      descargarBtn.disabled = false;
    } else {
      imagenCargada = false;
      descargarBtn.disabled = true;
    }
  });

  nombreInput.addEventListener('input', () => {
    nombrePlato.textContent = nombreInput.value.toUpperCase();
  });

  // fechaInput.addEventListener('input', () => {
  //   fecha.textContent = fechaInput.value;
  // });

  // telefonoInput.addEventListener('input', () => {
  //   const val = telefonoInput.value.replace(/[^0-9]/g, '').slice(0, 11);
  //   telefonoInput.value = val;
  //   telefono.textContent = val;
  // });

  function descargarImagen() {
    if (!imagenCargada) return;

    preview.style.display = "flex";
    setTimeout(() => {
      html2canvas(preview, {
        width: 1080,
        height: 1920,
        scale: 1,
        useCORS: true
      }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'menu-del-dia.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    }, 100); // tiempo para asegurar que se renderice bien
  }

    window.addEventListener('DOMContentLoaded', () => {
    const hoy = new Date();
    const dia = String(hoy.getDate()).padStart(2, '0');
    const mes = String(hoy.getMonth() + 1).padStart(2, '0');
    const fechaFormateada = `${dia}.${mes}`;
    document.getElementById('fecha').textContent = fechaFormateada;
  });
</script>

</body>
</html>
